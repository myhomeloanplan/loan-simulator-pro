<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>住宅ローンシミュレーター（compact +/−・％表示・万円）</title>

<!-- 外部ライブラリ -->
<link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@400;700;900&display=swap" rel="stylesheet">
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-dragdata@2.0.0"></script>
<script src="https://cdn.jsdelivr.net/npm/xlsx/dist/xlsx.full.min.js"></script>

<style>
/* ---------- カラーテーマ変数 ---------- */
:root{
--navy:#0e2a47; --teal:#10939a; --teal-2:#0c7e86;
--yellow:#ffbf3a; --yellow-2:#ffe28f; --bg:#f7fafc; --card:#ffffff;
--muted:#5f6f84; --ring:rgba(16,147,154,.25); --line:#e6edf5;
--coral:#ff4d6d; --coral-2:#ff6b81;
}

/* ---------- 基本レイアウト ---------- */
*{box-sizing:border-box}
body {
font-family:
'Noto Sans JP','Hiragino Kaku Gothic ProN','BIZ UDPGothic','Yu Gothic',
system-ui,-apple-system,Segoe UI,Roboto,sans-serif;
padding: 20px;
background: var(--bg);
max-width: 1100px;
margin: auto;
font-size: 18px;
color: #102a43;
background-image:
radial-gradient(ellipse at 10% -20%, rgba(255, 216, 97, .18), transparent 45%),
radial-gradient(ellipse at 110% 10%, rgba(25, 183, 181, .08), transparent 40%);
}

/* ---------- タイトル ---------- */
.title-wrap{ text-align:center; margin:6px 0 10px;}
.subtitle{
display:inline-block; margin-bottom:10px; font-weight:900; color:#0b4b77; letter-spacing:.08em;
}
.subtitle::before{ content:"＼ "; } .subtitle::after{ content:" ／"; }
.title{ margin:0; color:var(--navy); font-weight:900; letter-spacing:.02em; font-size:clamp(22px,4.5vw,32px);}

/* ---------- カード ---------- */
.card{ background:var(--card); border-radius:16px; padding:18px; margin-top:16px; box-shadow:0 8px 24px rgba(15,48,87,.08); border:1px solid #eef3f9;}
.panel-title{ display:flex; align-items:center; gap:.5rem; margin:-6px 0 14px; font-weight:900; color:#navy;
background:linear-gradient(90deg,var(--yellow),var(--yellow-2)); padding:.45rem .9rem; border-radius:999px; border:1px solid rgba(0,0,0,.06);
box-shadow:0 4px 0 rgba(15,48,87,.08); font-size:18px; width:fit-content; white-space:nowrap;}
.panel-title .chip{ display:inline-flex; align-items:center; justify-content:center; width:22px; height:22px; border-radius:999px;
background:linear-gradient(135deg,var(--teal),var(--teal-2)); color:#fff; font-weight:900; font-size:.9rem;}
.panel-title-save { margin-top: 16px; }

/* ---------- セクション見出し ---------- */
.section-title{ font-weight:900; font-size:16px; color:var(--navy); margin:18px 0 8px; padding:.35rem .7rem;
background:repeating-linear-gradient(-45deg, rgba(255,216,97,.35) 0 6px, rgba(255,216,97,.22) 6px 12px);
border-radius:8px; display:block; width:fit-content; white-space:nowrap; }

/* ---------- 入力（共通） ---------- */
.range-labels{ display:flex; justify-content:space-between; font-size:.9rem; color:var(--muted); margin:2px 0 0; }
.inline-group{ display:flex; align-items:center; gap:10px; flex-wrap:wrap; margin-top:6px;}
input[type="number"],input[type="text"],input[type="range"],select{
padding:.7rem .8rem; font-size:1rem; width:100%; border-radius:12px; border:1px solid #dfe8f2; background:#fff;
transition: box-shadow .15s ease, border-color .15s ease;
}
input[type="number"]:focus,input[type="text"]:focus,select:focus{ outline:none; border-color:var(--teal-2); box-shadow:0 0 0 4px var(--ring);}
input[type="range"]{ accent-color:var(--teal-2); }

/* フォームフォント統一 */
label,.inline-group label,select,option{
font-family:'Noto Sans JP','Hiragino Kaku Gothic ProN','Yu Gothic','Meiryo','BIZ UDPGothic',system-ui,sans-serif;
font-weight:500; font-size:1rem;
} 

/* ---------- ボタン ---------- */
.actions{display:grid; grid-template-columns: repeat(auto-fit, minmax(220px,1fr)); gap:12px; margin-top:12px;}
.btn{ appearance:none; -webkit-appearance:none; border:none; cursor:pointer; font-weight:900; letter-spacing:.02em;
padding:1rem; border-radius:12px; transition: transform .06s ease, box-shadow .2s ease, filter .2s ease;
font-size: calc(1rem + 2pt); }
.btn:active{ transform: translateY(1px); }
.btn-primary{ color:#fff; background:linear-gradient(135deg,var(--coral),var(--coral-2));
border:1px solid rgba(0,0,0,.12); box-shadow:0 10px 22px rgba(255,77,109,.35); }
.btn-ghost{ background:linear-gradient(135deg,#bfe8ea,#8fdde0); color:#083b40; border:1px solid #6fd0d3; box-shadow:0 4px 10px rgba(13,126,134,.18);}

/* ---------- KPI ---------- */
.kpi{ display:grid; grid-template-columns: repeat(auto-fit,minmax(220px,1fr)); gap:10px; margin-top:12px;}
.kpi .tile{ background:#fff; border:1px dashed #d9e6f3; border-radius:12px; padding:14px;}
.kpi .label{ font-size:.9rem; color:#3a5066;} .kpi .value{ font-weight:900; font-size:1.3rem; margin-top:4px; color:#102a43;}
#result{ white-space: pre-line; font-size:1rem; background:#fffef5; border:1px dashed #ffe28d; border-radius:10px; padding:10px;}

/* ---------- テーブル ---------- */
table{ width:100%; border-collapse:collapse; margin-top:18px; font-size:.95rem;}
th,td{ border:1px solid var(--line); padding:.6rem; text-align:right;}
th{ background:#f2fbfc; color:#0b4a4f; font-weight:800;}

/* ---------- グラフ ---------- */
.chart-block{ margin-top:14px; }
.chart-title{ font-size:16px; font-weight:800; color:var(--navy); margin:6px 4px; }
.chart-wrap{ width:100%; height:300px; background:linear-gradient(#fff,#fff) padding-box,
repeating-linear-gradient(0deg, #f2f7fb 0 28px, #e9f1f8 28px 29px) border-box;
border:1px solid #dfe8f2; border-radius:12px; padding:10px; overflow:hidden;}
.chart-wrap>canvas{ display:block; width:100% !important; height:100% !important;}
@media (max-width:640px){ .chart-wrap{ height:170px; } }

/* ---------- 半年ごとの金利入力行 ---------- */
.rate-input-row{ display:flex; align-items:center; gap:10px; margin-top:8px;}
.rate-input-row span{ width:20%; font-size:.95rem; color:var(--muted);} 
.rate-input-row input{ width:35%; }

/* 半年入力の見出し行（前半/後半） */
.rate-input-head{ display:flex; align-items:flex-end; gap:10px; margin:8px 0 6px; }
.rate-input-head .col-year{ width:20%; }
.rate-input-head .col-half{ width:35%; text-align:center; font-weight:800; color:#102a43; font-size:.95rem; letter-spacing:.02em; }
@media (max-width: 640px){ .rate-input-head{ display:none; } }

/* =========================================================
  金利一括入力ツールバー
  ========================================================= */
.rate-toolbar{ display:grid; grid-template-columns: auto 1fr auto; gap:10px; align-items:center; margin-top:8px; width:100%; }
.rate-field{
display:grid; grid-template-columns: 36px minmax(60px,84px) 18px 36px; align-items:center; gap:4px;
background:#fff; border:1px solid #dfe8f2; border-radius:12px; padding:6px 8px; width:max-content; max-width:100%;
}
.icon-btn{
-webkit-appearance:none; appearance:none; width:36px; height:36px; border:none; background:#e9f7f8; color:#0c7e86; border-radius:10px;
display:inline-flex; align-items:center; justify-content:center; font-size:20px; font-weight:900; box-shadow: inset 0 -2px 0 rgba(0,0,0,.05);
}
.icon-btn:active{ transform:translateY(1px); }
.rate-input{ width:84px; text-align:right; border:none; outline:none; font-weight:800; font-size:1rem; padding:.4rem .2rem; border-radius:8px; background:transparent; }
.rate-suffix{ font-weight:800; color:#0c7e86; text-align:center; user-select:none; }

/* ▼プルダウン */
.scope-field select{
-webkit-appearance:none; appearance:none; min-width:9.5em; height:44px; padding:0 .7rem; padding-right:2em;
border-radius:12px; border:1px solid #dfe8f2;
background:#fff url("data:image/svg+xml,%3Csvg fill='%230c7e86' height='20' viewBox='0 0 24 24' width='20' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M7 10l5 5 5-5z'/%3E%3C/svg%3E") no-repeat right 0.6em center;
background-size:1em; font-size:1rem; font-weight:700; cursor:pointer;
}

.btn-compact{
-webkit-appearance:none; appearance:none; color:#fff; background:linear-gradient(135deg,#0c7e86,#10939a);
border:1px solid rgba(0,0,0,.08); box-shadow:0 8px 18px rgba(12,126,134,.28);
padding:.5rem .9rem; font-size:0.95rem; border-radius:10px; display:inline-flex; gap:.4rem; align-items:center; font-weight:900; white-space:nowrap;
}
.btn-compact:hover{ filter:brightness(1.05); }
.btn-compact:active{ transform:translateY(1px); }

/* レスポンシブ */
@media (max-width: 640px){
.rate-toolbar{ grid-template-columns: auto 1fr; gap:8px; }
.btn-compact{ grid-column: 1 / -1; width:100%; justify-content:center; padding:.55rem .9rem; font-size:.95rem; }
.rate-field{ grid-template-columns: 32px minmax(52px,72px) 16px 32px; padding:4px 6px; }
.icon-btn{ width:32px; height:32px; font-size:18px; }
.rate-input{ width:72px; font-size:.95rem; padding:.3rem .18rem; }
.rate-suffix{ font-size:.95rem; }
.scope-field select{ min-width:8.2em; height:40px; padding:0 .6rem; padding-right:2em; }
}
@media (min-width: 768px){
.rate-field{ height:44px; padding:0 8px; }
.scope-field select{ height:44px; }
.btn-compact{ height:44px; padding:0 1rem; }
}

/* ===== まとめパネル ===== */
.visually-hidden{ position:absolute !important; width:1px; height:1px; padding:0; margin:-1px; overflow:hidden; clip:rect(0,0,0,0); white-space:nowrap; border:0; }
.summary-panel { background-color:#13807e; border-radius:12px; padding:16px; color:#fff; font-weight:bold; margin-bottom:20px; box-shadow:0 8px 24px rgba(0,0,0,0.08); }
.summary-grid { display:grid; grid-template-columns:1fr 1fr; gap:14px; margin-bottom:12px; }
.summary-item { padding:12px 0; border-bottom:1px solid rgba(255,255,255,0.4); }
.summary-item:last-child { border-bottom:none; }
.summary-item .summary-label { font-weight:700; font-size:1rem; margin-bottom:4px; }
.summary-item .summary-value { font-weight:900; font-size:1.6rem; }
.summary-subtitle { font-weight:700; font-size:1rem; margin:12px 0 6px; }
.summary-list { list-style:none; padding:0; margin:0; }
.summary-row { display:flex; justify-content:space-between; align-items:center; padding:10px 0; border-bottom:1px solid rgba(255,255,255,0.4); }
.summary-row:last-child { border-bottom:none; }
.summary-row .row-label { font-size:1rem; }
.summary-row .row-value { font-size:1.3rem; font-weight:900; }
@media (max-width:720px){ .summary-grid{ grid-template-columns:1fr; } }

.savebar{ display:flex; gap:10px; align-items:center; flex-wrap:wrap; margin-top:8px; }
.savebar input{ flex:1 1 240px; min-width:200px; padding:.6rem .8rem; border:1px solid #dfe8f2; border-radius:10px; background:#fff; }

.saved-compare{ margin-top:14px; }
.saved-wrap{ display:grid; grid-template-columns: repeat(auto-fit,minmax(260px,1fr)); gap:10px; }

.saved-card{ background:#fff; border:1px solid #eef3f9; border-radius:12px; padding:12px; box-shadow:0 6px 18px rgba(15,48,87,.05); }
.saved-head{ display:flex; justify-content:space-between; align-items:center; margin-bottom:6px; }
.saved-title{ font-weight:900; color:#0e2a47; font-size:1rem; }
.saved-meta{ color:#5f6f84; font-size:.8rem; }
.saved-kpis{ display:grid; grid-template-columns:1fr; gap:4px; margin-top:6px; }
.saved-kpis .row{ display:flex; justify-content:space-between; font-size:.95rem; }
.saved-actions{ display:flex; gap:8px; margin-top:8px; }
.btn-mini{ font-size:.85rem; padding:.4rem .6rem; border-radius:8px; }
.btn-danger{ background:#ffe8ec; border:1px solid #ffd0d8; color:#7a1026; }

/* ▼ 金利プリセットUI */
.rate-presets{ display:flex; gap:8px; align-items:center; flex-wrap:wrap; margin-top:8px; }
@media (min-width: 768px){
  .rate-presets{ display:grid; grid-template-columns: 1fr auto; align-items:center; gap: 8px; }
  .rate-presets select{ width:100%; }
}
.rate-section-title { font-size: 0.95rem; font-weight: 600; color: #555; margin: 0 0 6px 0; border-left: 4px solid #0c7e72; padding-left: 6px; }
.preset-title { margin-top: 16px; }

/* マイプリセット行 */
.my-presets-row{ display:grid; grid-template-columns: 1fr auto auto; gap:8px; align-items:center; margin-top:8px; }
@media (max-width:640px){ .my-presets-row{ grid-template-columns: 1fr; } }

/* ---------- フッター ---------- */
.site-footer { text-align: center; font-size: 0.85rem; color: #666; margin-top: 40px; padding: 12px 0; border-top: 1px solid rgba(0,0,0,0.08); background: #f9f9f9; }
@media (prefers-color-scheme: dark) {
.site-footer { color: #aaa; background: #1c1c1c; border-top-color: rgba(255,255,255,0.08); }
}
/* Proバッジ */
.badge-pro { display:inline-block; margin-left:8px; padding:2px 6px; font-size:.8em; font-weight:700; color:#fff; background:#0c7e72; border-radius:6px; vertical-align:middle; }
</style>
</head>

<body onload="generateRateInputs()">
<div class="title-wrap">
  <div class="subtitle">半年ごとに金利を変更できる</div>
  <h1 class="title">住宅ローンシミュレーター <span class="badge-pro">Pro</span></h1>
</div>

<!-- =============== 条件入力カード =============== -->
<div class="card">
  <div class="panel-title"><span class="chip">1</span>条件</div>

  <!-- 借入額 -->
  <div class="section-title">借入額（万円）</div>
  <input type="text" id="amount" value="3000" oninput="syncAmountFromText()" />
  <input type="range" id="amount-range" min="1000" max="10000" step="10" value="3000" oninput="syncAmountFromRange()" />
